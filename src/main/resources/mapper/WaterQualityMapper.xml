<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.jingc.mapper.WaterQualityMapper">
    <insert id="batchInsertData">
        insert into water_quality
        (
        sea,
        province,
        city,
        site,
        longitude,
        latitude,
        monitor_month,
        pH,
        dissolved_oxygen,
        chemical_oxygen_demand,
        inorganic_nitrogen,
        active_phosphate,
        petroleum,
        water_quality_classification
        )
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (#{item.sea},
            #{item.province},
            #{item.city},
            #{item.site},
            #{item.longitude},
            #{item.latitude},
            #{item.monitorMonth},
            #{item.pH},
            #{item.dissolvedOxygen},
            #{item.chemicalOxygenDemand},
            #{item.inorganicNitrogen},
            #{item.activePhosphate},
            #{item.petroleum},
            #{item.waterQualityClassification}
            )
        </foreach>
    </insert>

    <insert id="insertData">
        insert into water_quality
        (
        sea,
        province,
        city,
        site,
        longitude,
        latitude,
        monitor_month,
        pH,
        dissolved_oxygen,
        chemical_oxygen_demand,
        inorganic_nitrogen,
        active_phosphate,
        petroleum,
        water_quality_classification
        )
        values
        (
        #{sea},
        #{province},
        #{city},
        #{site},
        #{longitude},
        #{latitude},
        #{monitorMonth},
        #{pH},
        #{dissolvedOxygen},
        #{chemicalOxygenDemand},
        #{inorganicNitrogen},
        #{activePhosphate},
        #{petroleum},
        #{waterQualityClassification}
        )
    </insert>
    <select id="getWaterData" resultType="org.jingc.entity.WaterQuality">
        select * from water_quality LIMIT 1000;
    </select>
    <select id="getDataByTime" resultType="org.jingc.entity.WaterQuality">
        select * from water_quality where monitor_month = #{time} ;
    </select>
    <select id="getDataBySiteInfo" resultType="org.jingc.entity.WaterQuality">
        select * from water_quality where site = #{site};
    </select>
    <select id="getByCityAndYear" resultType="org.jingc.entity.WaterQuality">
        select *
        from
        water_quality
        where city = #{city}
        and monitor_month = #{time}
        and water_quality_classification = #{waterQualityClassification};
    </select>
    <select id="getAllCityByTime" resultType="java.lang.String">
        select distinct city
        from water_quality
        where monitor_month = #{time}
        and water_quality_classification = #{waterQualityClassification};
    </select>
</mapper>